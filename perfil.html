<script>
  const urlParams = new URLSearchParams(window.location.search);
  const nombre = urlParams.get("nino") || "david";

  fetch(`data/${nombre}.json`)
    .then(res => {
      if (!res.ok) throw new Error("Ni√±o no encontrado");
      return res.json();
    })
    .then(datos => {
      // Separar las notas en p√°rrafos
      const parrafosNotas = datos.notas
        .split(". ")
        .map(p => p.trim())
        .filter(p => p.length > 0);

      let html = `
        <h2>üö® Datos de ${datos.nombre}</h2>
        <p><strong>Edad:</strong> ${datos.edad || "No especificado"} a√±os</p>
        <p><strong>Tipo de Sangre:</strong> ${datos.tipo_de_sangre || "No especificado"}</p>
        <p><strong>Diagn√≥stico:</strong> ${datos.diagnostico || "No especificado"}</p>
        <p><strong>Alergias:</strong> ${datos.alergias === "" ? "Ninguna" : datos.alergias}</p>

        <p><strong>Contacto Principal:</strong></p>
        <ul>
          <li><strong>Nombre:</strong> ${datos.contacto1?.nombre || "No especificado"}</li>
          <li><strong>Parentesco:</strong> ${datos.contacto1?.parentesco || "No especificado"}</li>
          <li><strong>Tel√©fono:</strong> ${datos.contacto1?.telefono || "No especificado"}</li>
        </ul>
      `;

      // Mostrar contacto secundario si existe
      if (Object.keys(datos.contacto2).length > 0 && 
          (datos.contacto2.nombre || datos.contacto2.parentesco || datos.contacto2.telefono)) {

        html += `
          <p><strong>Contacto Secundario:</strong></p>
          <ul>
            <li><strong>Nombre:</strong> ${datos.contacto2.nombre || "No especificado"}</li>
            <li><strong>Parentesco:</strong> ${datos.contacto2.parentesco || "No especificado"}</li>
            <li><strong>Tel√©fono:</strong> ${datos.contacto2.telefono || "No especificado"}</li>
          </ul>
        `;
      }

      html += `<p><strong>Notas importantes:</strong></p>`;
      parrafosNotas.forEach(parrafo => {
        html += `<p>${parrafo}.</p>`;
      });

      document.getElementById("datos").innerHTML = html;
    })
    .catch(err => {
      document.getElementById("datos").innerHTML = "<p>Error: Ni√±o no encontrado.</p>";
      console.error("Error al cargar datos:", err);
    });
</script>